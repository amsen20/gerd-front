import { getPersian, getSortedPlayers, getTeams, getPlayer } from "../utils";
import styles from "./finishedPage.module.css";

function getWinnerSVG() {
    return <svg width="290" height="290" viewBox="0 0 290 290" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path opacity="0.4" d="M217.5 247.708H205.417V244.687C205.417 231.395 194.542 220.52 181.25 220.52H154.062V192.85C151.042 193.212 148.021 193.333 145 193.333C141.979 193.333 138.958 193.212 135.938 192.85V220.52H108.75C95.4583 220.52 84.5833 231.395 84.5833 244.687V247.708H72.5C67.5458 247.708 63.4375 251.816 63.4375 256.77C63.4375 261.725 67.5458 265.833 72.5 265.833H217.5C222.454 265.833 226.562 261.725 226.562 256.77C226.562 251.816 222.454 247.708 217.5 247.708Z" fill="#FFE600" />
        <path opacity="0.4" d="M66.6999 140.65C58.7249 137.63 51.7165 132.675 46.1582 127.117C34.9207 114.671 27.5498 99.8087 27.5498 82.4087C27.5498 65.0087 41.204 51.3545 58.604 51.3545H65.3707C62.229 57.7587 60.4165 64.8878 60.4165 72.5003V108.75C60.4165 120.109 62.5915 130.863 66.6999 140.65Z" fill="#FFE600" />
        <path opacity="0.4" d="M262.45 82.4087C262.45 99.8087 255.079 114.671 243.842 127.117C238.283 132.675 231.275 137.63 223.3 140.65C227.408 130.863 229.583 120.109 229.583 108.75V72.5003C229.583 64.8878 227.771 57.7587 224.629 51.3545H231.396C248.796 51.3545 262.45 65.0087 262.45 82.4087Z" fill="#FFE600" />
        <path d="M181.25 24.167H108.75C82.0457 24.167 60.4165 45.7962 60.4165 72.5003V108.75C60.4165 155.513 98.2374 193.334 145 193.334C191.762 193.334 229.583 155.513 229.583 108.75V72.5003C229.583 45.7962 207.954 24.167 181.25 24.167ZM179.317 102.104L171.825 111.288C170.617 112.617 169.771 115.275 169.892 117.088L170.617 128.929C171.1 136.179 165.904 139.925 159.137 137.267L148.142 132.917C146.45 132.313 143.55 132.313 141.858 132.917L130.862 137.267C124.096 139.925 118.9 136.179 119.383 128.929L120.108 117.088C120.229 115.275 119.383 112.617 118.175 111.288L110.683 102.104C105.971 96.5462 108.025 90.3837 115.033 88.5712L126.512 85.6712C128.325 85.1878 130.5 83.4962 131.467 81.9253L137.871 72.017C141.858 65.8545 148.142 65.8545 152.129 72.017L158.533 81.9253C159.5 83.4962 161.675 85.1878 163.487 85.6712L174.967 88.5712C181.975 90.3837 184.029 96.5462 179.317 102.104Z" fill="#FFE600" />
        <path opacity="0.4" d="M179.317 102.104L171.825 111.287C170.617 112.616 169.771 115.275 169.892 117.087L170.617 128.929C171.1 136.179 165.904 139.925 159.138 137.266L148.142 132.916C146.45 132.312 143.55 132.312 141.859 132.916L130.863 137.266C124.096 139.925 118.9 136.179 119.384 128.929L120.109 117.087C120.229 115.275 119.384 112.616 118.175 111.287L110.684 102.104C105.971 96.5455 108.025 90.383 115.034 88.5705L126.513 85.6705C128.325 85.1872 130.5 83.4955 131.467 81.9247L137.871 72.0164C141.859 65.8539 148.142 65.8539 152.129 72.0164L158.534 81.9247C159.5 83.4955 161.675 85.1872 163.488 85.6705L174.967 88.5705C181.975 90.383 184.029 96.5455 179.317 102.104Z" fill="#FFE600" />
    </svg>
}

function getDrawSVG() {
    return <svg width="210" height="210" viewBox="0 0 210 210" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M45.0625 192.5C41.475 192.5 38.5 189.525 38.5 185.938V24.0625C38.5 20.475 41.475 17.5 45.0625 17.5C48.65 17.5 51.625 20.475 51.625 24.0625V185.938C51.625 189.525 48.65 192.5 45.0625 192.5Z" fill="white" />
        <path opacity="0.4" d="M157.675 107.887L147 97.2124C144.462 95.0249 142.975 91.7874 142.887 88.1999C142.712 84.2624 144.287 80.3249 147.175 77.4374L157.675 66.9374C166.775 57.8374 170.187 49.0874 167.3 42.1749C164.5 35.3499 155.837 31.5874 143.062 31.5874H45.0623C43.2248 31.6749 41.7373 33.1624 41.7373 34.9999V140C41.7373 141.837 43.2248 143.325 45.0623 143.325H143.062C155.662 143.325 164.15 139.475 167.037 132.562C169.925 125.562 166.6 116.9 157.675 107.887Z" fill="white" />
    </svg>
}

export default function Finished({ room }) {
    const { team_one_score, team_two_score } = room.match;

    const winnerTeam = team_one_score > team_two_score ? 1 : 2;

    const isDraw = team_one_score === team_two_score;
    const players = getSortedPlayers(room);
    const teams = getTeams(room);
    const winners = [];

    for (let i = 0; i < players.length; i++)
        if (teams[i] === winnerTeam)
            winners.push(players[i]);

    let innerBlock;
    if (isDraw)
        innerBlock = <div className={styles.iconHolder}>
            {getDrawSVG()}
        </div>;
    else
        innerBlock = <div className={styles.iconHolder}>
            {getWinnerSVG()}
            <p>
                {winners[0]}-{winners[1]}
            </p>
        </div>;

    return <div className={styles.finishedPageHolder}>
        <div className={styles.finishedPage}>
            <div className={styles.finishedPageTopBar}>
                <div className={styles.circlesWrapper}>
                    {getPlayer(styles, true, 1, false, true)}
                </div>
                <p className={styles.scores}>
                    {getPersian(team_one_score)}
                    -
                    {getPersian(team_two_score)}
                </p>
                <div className={styles.circlesWrapper}>
                    {getPlayer(styles, true, 2, false, true)}
                </div>
            </div>
            {innerBlock}
            <p>
                {isDraw ? 'مساوی شد!' : 'برنده شدن!'}
            </p>
        </div>
    </div>;
}